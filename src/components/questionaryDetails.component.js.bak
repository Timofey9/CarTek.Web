import React, { useEffect, useState } from 'react';
import { useParams } from 'react-router-dom'
import ApiService from "../services/cartekApiService";
import ImageList from '@mui/material/ImageList';
import ImageListItem from '@mui/material/ImageListItem';

function QuestionaryDetailsComponent() {

    let { cancelled } = false;
    const [images, setImages] = useState([]);
    const [loading, setLoading] = useState(true);
    let { uniqueId } = useParams();

    useEffect(() => {
        setLoading(true);
        ApiService.getQuestionaryImages(uniqueId)
            .then(({ data }) => {
                console.log(data);
                setImages(data);
                setLoading(false);
            })
            .catch((error) => {
                setLoading(false);
            });
        return () => cancelled = true;
    }, []);

    const imagesList = images.map(image => {
        return <ImageListItem key={image.fileName}>
            <img
                src={`data:image/${image.extension};base64,${image.binaryData}`}
                srcSet={`data:image/${image.extension};base64,${image.binaryData}`}
                alt={image.fileName}
                loading="lazy"
            />
        </ImageListItem>
    });

    if (loading) {
        return <div><h1>«¿√–”« ¿...</h1></div>
    }

    return (
        <div>
            <div className="row">
                <div className="col-md-8">
                </div>
                <div className="col-md-4">
                    <input type="button" className="btn btn-success pull-right" value="–Â‰‡ÍÚËÓ‚‡Ú¸" />
                </div>
            </div>
            <div className="row">
                <div className="col-md-12">
                    <ImageList sx={{ width: 500, height: 450 }} cols={3} rowHeight={164}>
                        {imagesList}
                    </ImageList>
                </div>
            </div>

        </div>);
}

export default QuestionaryDetailsComponent;